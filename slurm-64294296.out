SLURM_JOB_ID: 64294296
SLURM_JOB_USER: vsc37132
SLURM_JOB_ACCOUNT: intro_vsc37132
SLURM_JOB_NAME: mini_test_debug
SLURM_CLUSTER_NAME: wice
SLURM_JOB_PARTITION: gpu_a100_debug
SLURM_NNODES: 1
SLURM_NODELIST: k28i22
SLURM_JOB_CPUS_PER_NODE: 4
SLURM_JOB_GPUS: 0
Date: Sat Apr  5 17:26:36 CEST 2025
Walltime: 00-00:30:00
========================================================================
Environment variables:
PYTHONPATH=:/data/leuven/371/vsc37132/qtype-eval:/vsc-hard-mounts/leuven-user/371/vsc37132:/vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval
HF_HOME=/data/leuven/371/vsc37132/qtype-eval/data/cache
TRANSFORMERS_OFFLINE=1
HF_DATASETS_OFFLINE=1
Python executable: /data/leuven/371/vsc37132/miniconda3/envs/qtype-eval/bin/python
PyTorch CUDA available: True
Checking cache directory contents:
total 28
drwxr-x---  6 vsc37132 vsc37132 8192 Apr  5 16:13 .
drwxr-x---  5 vsc37132 vsc37132 4096 Apr  3 17:23 ..
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 17:21 data_cache_rokokot___question-type-and-complexity_base_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_avg_links_len_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_avg_links_len_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_links_len_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_max_depth_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_max_depth_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_max_depth_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_subordinate_chain_len_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_subordinate_chain_len_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_subordinate_chain_len_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_verb_edges_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_verb_edges_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_avg_verb_edges_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_complexity_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_complexity_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_complexity_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_lexical_density_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_lexical_density_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_lexical_density_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_n_tokens_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:35 data_cache_rokokot___question-type-and-complexity_control_n_tokens_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:36 data_cache_rokokot___question-type-and-complexity_control_n_tokens_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_question_type_seed1_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_question_type_seed2_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  3 20:34 data_cache_rokokot___question-type-and-complexity_control_question_type_seed3_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
-rw-r-----  1 vsc37132 vsc37132    0 Apr  5 16:13 _data_leuven_371_vsc37132_qtype-eval_data_cache_rokokot___question-type-and-complexity_base_0.0.0_73f7e9fabe3af1c8a61564a268551f52ed221358.lock
drwxr-x---  3 vsc37132 vsc37132 4096 Apr  3 20:36 .locks
drwxr-x---  6 vsc37132 vsc37132 4096 Apr  3 20:36 models--cis-lmu--glot500-base
drwxr-x---  3 vsc37132 vsc37132 4096 Apr  5 15:57 modules
drwxr-x--- 27 vsc37132 vsc37132 4096 Apr  3 20:36 rokokot___question-type-and-complexity
Model directory:
total 28
drwxr-x--- 6 vsc37132 vsc37132 4096 Apr  3 20:36 .
drwxr-x--- 6 vsc37132 vsc37132 8192 Apr  5 16:13 ..
drwxr-x--- 2 vsc37132 vsc37132 4096 Apr  3 20:36 blobs
drwxr-x--- 3 vsc37132 vsc37132 4096 Apr  3 20:36 .no_exist
drwxr-x--- 2 vsc37132 vsc37132 4096 Apr  3 20:36 refs
drwxr-x--- 3 vsc37132 vsc37132 4096 Apr  3 20:36 snapshots
Testing tokenizer loading:
Error loading tokenizer: We couldn't connect to 'https://huggingface.co' to load the files, and couldn't find them in the cached files.
Checkout your internet connection or see how to run the library in offline mode at 'https://huggingface.co/docs/transformers/installation#offline-mode'.
Testing dataset loading:
Error loading dataset: Couldn't reach 'rokokot/question-type-and-complexity' on the Hub (OfflineModeIsEnabled)
Running mini experiment...
/data/leuven/371/vsc37132/miniconda3/envs/qtype-eval/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:415: UserWarning: In config: Invalid overriding of hydra/launcher:
Default list overrides requires 'override' keyword.
See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/defaults_list_override for more information.

  deprecation_warning(msg)
/data/leuven/371/vsc37132/miniconda3/envs/qtype-eval/lib/python3.9/runpy.py:197: UserWarning: 
'hydra/launcher/submitit_slurm' is validated against ConfigStore schema with the same name.
This behavior is deprecated in Hydra 1.1 and will be removed in Hydra 1.2.
See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/automatic_schema_matching for migration instructions.
  return _run_code(code, main_globals, None,
/data/leuven/371/vsc37132/miniconda3/envs/qtype-eval/lib/python3.9/site-packages/hydra/main.py:94: UserWarning: 
'hydra/launcher/submitit_slurm' is validated against ConfigStore schema with the same name.
This behavior is deprecated in Hydra 1.1 and will be removed in Hydra 1.2.
See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/automatic_schema_matching for migration instructions.
  _run_hydra(
/data/leuven/371/vsc37132/miniconda3/envs/qtype-eval/lib/python3.9/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
Using Dataset: rokokot/question-type-and-complexity
Cache Directory: /data/leuven/371/vsc37132/qtype-eval/data/cache
[2025-04-05 17:27:41,034][__main__][INFO] - Configuration:
seed: 42
output_dir: ./mini_test_output
experiment_name: mini_test_glot500_en
wandb:
  project: multilingual-question-probing
  entity: rokii-ku-leuven
  mode: offline
slurm:
  partition: gpu
  time: '24:00:00'
  gpus_per_node: 1
  cpus_per_task: 4
  mem_per_cpu: 8
  job_name: ${experiment_name}
  account: intro_vsc37132
data:
  dataset_name: rokokot/question-type-and-complexity
  cache_dir: /data/leuven/371/vsc37132/qtype-eval/data/cache
  vectors_dir: ./data/features
  languages:
  - en
  train_language: null
  eval_language: null
model:
  model_type: lm_probe
  lm_name: cis-lmu/glot500-base
  dropout: 0.1
  freeze_model: false
  layer_wise: false
  layer_index: -1
training:
  task_type: classification
  batch_size: 8
  num_epochs: 3
  lr: 1.0e-05
  weight_decay: 0.01
  patience: 3
  scheduler_factor: 0.5
  scheduler_patience: 2
  random_state: 42
  num_workers: 4
experiment:
  type: lm_probe
  tasks:
  - question_type
  use_controls: false
  control_index: null
  num_controls: 3
  eval_on_orig_test: true
  cross_lingual: false

[2025-04-05 17:27:41,126][__main__][INFO] - Using task: ['question_type']
[2025-04-05 17:27:41,126][__main__][INFO] - Running LM probe experiment for ['question_type'] on languages: ['en']
[2025-04-05 17:27:41,144][__main__][INFO] - Processing language: en
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.9
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[2025-04-05 17:27:44,235][src.data.datasets][INFO] - Found model snapshot: /data/leuven/371/vsc37132/qtype-eval/data/cache/models--cis-lmu--glot500-base/snapshots/d4d7c1ec01828fdf7452a4ccf7b55177aced175e
[2025-04-05 17:27:47,730][src.data.datasets][INFO] - Successfully loaded tokenizer for cis-lmu/glot500-base
[2025-04-05 17:27:47,731][src.data.datasets][INFO] - Loading base dataset for en language (train)
Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
[2025-04-05 17:27:47,948][datasets.load][WARNING] - Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,088][datasets.packaged_modules.cache.cache][WARNING] - Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,312][src.data.datasets][INFO] - Loaded 1192 examples for en (train)
[2025-04-05 17:27:48,315][src.data.datasets][INFO] - Loading base dataset for en language (validation)
Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
[2025-04-05 17:27:48,389][datasets.load][WARNING] - Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,432][datasets.packaged_modules.cache.cache][WARNING] - Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,479][src.data.datasets][INFO] - Loaded 72 examples for en (validation)
[2025-04-05 17:27:48,481][src.data.datasets][INFO] - Loading base dataset for en language (test)
Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
[2025-04-05 17:27:48,560][datasets.load][WARNING] - Using the latest cached version of the dataset since rokokot/question-type-and-complexity couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,613][datasets.packaged_modules.cache.cache][WARNING] - Found the latest cached dataset configuration 'base' at /data/leuven/371/vsc37132/qtype-eval/data/cache/rokokot___question-type-and-complexity/base/0.0.0/73f7e9fabe3af1c8a61564a268551f52ed221358 (last modified on Sat Apr  5 16:13:11 2025).
[2025-04-05 17:27:48,647][src.data.datasets][INFO] - Loaded 110 examples for en (test)
[2025-04-05 17:27:48,648][src.data.datasets][INFO] - Train data columns: ['unique_id', 'text', 'language', 'avg_links_len', 'avg_max_depth', 'avg_subordinate_chain_len', 'avg_verb_edges', 'lexical_density', 'n_tokens', 'question_type', 'complexity_score', 'lang_norm_complexity_score']
[2025-04-05 17:27:48,649][src.data.datasets][INFO] - Sample text: Did Nvidia skip the 800 series for graphics cards?...
[2025-04-05 17:27:48,649][src.data.datasets][WARNING] - Feature 'None' not found in columns: ['unique_id', 'text', 'language', 'avg_links_len', 'avg_max_depth', 'avg_subordinate_chain_len', 'avg_verb_edges', 'lexical_density', 'n_tokens', 'question_type', 'complexity_score', 'lang_norm_complexity_score']
[2025-04-05 17:27:48,650][src.data.datasets][ERROR] - Error creating datasets: ['question_type']
[2025-04-05 17:27:48,662][src.data.datasets][ERROR] - Traceback: Traceback (most recent call last):
  File "/vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval/src/data/datasets.py", line 333, in create_lm_dataloaders
    train_dataset = LMQuestionDataset(train_df, tokenizer, task)
  File "/vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval/src/data/datasets.py", line 73, in __init__
    feature_name = TASK_TO_FEATURE[task]
KeyError: ['question_type']

[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Error in create_lm_dataloaders: ['question_type']
[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Traceback: Traceback (most recent call last):
  File "/vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval/src/data/datasets.py", line 333, in create_lm_dataloaders
    train_dataset = LMQuestionDataset(train_df, tokenizer, task)
  File "/vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval/src/data/datasets.py", line 73, in __init__
    feature_name = TASK_TO_FEATURE[task]
KeyError: ['question_type']

[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Task: ['question_type']
[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Model name: cis-lmu/glot500-base
[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Cache directory: /data/leuven/371/vsc37132/qtype-eval/data/cache
[2025-04-05 17:27:48,663][src.data.datasets][ERROR] - Language: en
[2025-04-05 17:27:48,663][__main__][ERROR] - Failed to create dataloaders for en: ['question_type']
[2025-04-05 17:27:48,663][__main__][ERROR] - Error details: ['question_type']
[2025-04-05 17:27:48,905][__main__][INFO] - Results saved to ./mini_test_output/all_results.json
wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /vsc-hard-mounts/leuven-data/371/vsc37132/qtype-eval/outputs/mini_test_glot500_en/2025-04-05/17-27-40/wandb/offline-run-20250405_172741-bylp797v
wandb: Find logs at: ./wandb/offline-run-20250405_172741-bylp797v/logs
Output directory contents:
total 8
drwxr-x---  2 vsc37132 vsc37132 4096 Apr  5 17:26 .
drwxr-x--- 14 vsc37132 vsc37132 4096 Apr  5 17:26 ..
cat: mini_test_output/all_results.json: No such file or directory
No results file found
Error files if any:
No error files found
Mini test completed
GPU memory usage:
memory.used [MiB]
1 MiB
